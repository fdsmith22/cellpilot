<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <?!= include('SharedStyles'); ?>
  <style>
    /* Industry template grid - cleaner 3x2 layout */
    .industry-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 8px;
      margin-bottom: 20px;
      padding: 8px;
      background: var(--gray-50);
      border-radius: 10px;
      border: 1px solid var(--gray-100);
    }
    
    .industry-btn {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 10px 6px;
      border: 1px solid var(--gray-200);
      border-radius: 8px;
      background: white;
      color: var(--gray-700);
      font-size: 10px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s ease;
      min-height: 54px;
      text-align: center;
    }
    
    .industry-btn:hover {
      border-color: var(--primary-200);
      background: var(--primary-50);
      transform: translateY(-1px);
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
    }
    
    .industry-btn.active {
      background: white;
      border-color: var(--primary-400);
      color: var(--primary-600);
      box-shadow: 0 2px 6px rgba(99, 102, 241, 0.15);
    }
    
    .industry-icon {
      width: 22px;
      height: 22px;
      border-radius: 5px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 10px;
      font-weight: 600;
      margin-bottom: 4px;
      background: var(--gray-100);
      color: var(--gray-700);
      letter-spacing: -0.5px;
    }
    
    .industry-btn.active .industry-icon {
      background: linear-gradient(135deg, var(--primary-500), var(--primary-600));
      color: white;
    }
    
    .industry-label {
      font-size: 9px;
      line-height: 1.2;
    }
    
    /* Feature cards - more refined design */
    .feature-card {
      max-width: 100%;
      word-wrap: break-word;
      cursor: pointer;
      transition: all 0.2s ease;
      padding: 18px;
      border: 1px solid var(--gray-200);
      border-radius: 10px;
      background: white;
      margin-bottom: 14px;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.04);
    }
    
    .feature-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
      border-color: var(--primary-200);
    }
    
    .feature-title {
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 8px;
      color: var(--gray-900);
    }
    
    .feature-description {
      font-size: 12px;
      color: var(--gray-600);
      margin-bottom: 10px;
      line-height: 1.5;
    }
    
    .feature-benefits {
      font-size: 11px;
      color: var(--primary-600);
      font-weight: 500;
      margin-bottom: 14px;
      padding: 8px;
      background: var(--primary-50);
      border-radius: 6px;
      border-left: 3px solid var(--primary-400);
    }
    
    .template-actions {
      display: flex;
      gap: 8px;
      margin-top: 12px;
    }
    
    .btn-preview {
      flex: 1;
      padding: 8px 12px;
      background: var(--gray-100);
      color: var(--gray-700);
      border: 1px solid var(--gray-300);
      border-radius: 6px;
      font-size: 11px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    
    .btn-preview:hover {
      background: var(--gray-200);
      border-color: var(--gray-400);
    }
    
    .btn-apply {
      flex: 2;
      padding: 8px 12px;
      background: var(--primary-600);
      color: white;
      border: 1px solid var(--primary-600);
      border-radius: 6px;
      font-size: 11px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    
    .btn-apply:hover {
      background: var(--primary-700);
      border-color: var(--primary-700);
    }
    
    .feature-grid {
      display: block;
    }
    
    .template-item {
      max-width: 100%;
      overflow: hidden;
    }
  </style>
</head>
<body>
  <div class="nav-header">
    <button class="nav-back" onclick="backToMain()">←</button>
    <div class="nav-title">
      <h2>Industry Templates</h2>
      <p>Pre-built solutions saving 15-25 hours weekly</p>
    </div>
  </div>
  
  <div class="container">
    <div id="statusMessage" style="display: none;"></div>
    
    <!-- Industry Categories Grid -->
    <div class="industry-grid">
      <button class="industry-btn active" onclick="switchCategory('real-estate')">
        <div class="industry-icon">RE</div>
        <div class="industry-label">Real Estate</div>
      </button>
      <button class="industry-btn" onclick="switchCategory('construction')">
        <div class="industry-icon">CO</div>
        <div class="industry-label">Construction</div>
      </button>
      <button class="industry-btn" onclick="switchCategory('healthcare')">
        <div class="industry-icon">HC</div>
        <div class="industry-label">Healthcare</div>
      </button>
      <button class="industry-btn" onclick="switchCategory('marketing')">
        <div class="industry-icon">MK</div>
        <div class="industry-label">Marketing</div>
      </button>
      <button class="industry-btn" onclick="switchCategory('ecommerce')">
        <div class="industry-icon">EC</div>
        <div class="industry-label">E-Commerce</div>
      </button>
      <button class="industry-btn" onclick="switchCategory('professional')">
        <div class="industry-icon">PS</div>
        <div class="industry-label">Professional Services</div>
      </button>
    </div>
    
    <!-- Real Estate Templates -->
    <div id="real-estate" class="category-content">
      <div class="feature-grid">
        <div class="feature-card">
          <div class="feature-title">Commission Tracker & Client Pipeline</div>
          <div class="feature-description">Complete real estate business management with commission tracking, client pipeline management, and performance analytics. Includes automated commission splits, closing timeline tracking, and lead conversion analysis.</div>
          <div class="feature-benefits">✓ Saves 8+ hours weekly ✓ Track 25% more deals ✓ Automate commission calculations</div>
          <div class="template-actions">
            <button class="btn-preview" onclick="previewTemplate('commission-tracker')">Preview</button>
            <button class="btn-apply" onclick="applyTemplate('commission-tracker')">Apply Template</button>
          </div>
        </div>
        
        <div class="feature-card">
          <div class="feature-title">Property Management Suite</div>
          <div class="feature-description">End-to-end property management system with rent collection tracking, maintenance scheduling, tenant management, and financial reporting. Perfect for landlords and property management companies.</div>
          <div class="feature-benefits">✓ Saves 12+ hours weekly ✓ Zero missed rent payments ✓ Automated maintenance alerts</div>
          <div class="template-actions">
            <button class="btn-preview" onclick="previewTemplate('property-manager')">Preview</button>
            <button class="btn-apply" onclick="applyTemplate('property-manager')">Apply Template</button>
          </div>
        </div>
        
        <div class="feature-card">
          <div class="feature-title">Investment Analysis Dashboard</div>
          <div class="feature-description">Professional investment property analysis with cash flow projections, cap rate calculations, ROI analysis, and comparative market analysis tools. Make data-driven investment decisions.</div>
          <div class="feature-benefits">✓ 7%+ better returns ✓ Risk analysis tools ✓ Market comparison features</div>
          <div class="template-actions">
            <button class="btn-preview" onclick="previewTemplate('investment-analyzer')">Preview</button>
            <button class="btn-apply" onclick="applyTemplate('investment-analyzer')">Apply Template</button>
          </div>
        </div>
        
        <div class="feature-card">
          <div class="feature-title">Lead Management & CRM</div>
          <div class="feature-description">Comprehensive lead tracking system with follow-up scheduling, lead scoring, conversion tracking, and automated nurture campaigns. Turn more leads into closed deals.</div>
          <div class="feature-benefits">✓ 25% more conversions ✓ Automated follow-ups ✓ Lead scoring system</div>
          <div class="template-actions">
            <button class="btn-preview" onclick="previewTemplate('lead-pipeline')">Preview</button>
            <button class="btn-apply" onclick="applyTemplate('lead-pipeline')">Apply Template</button>
          </div>
        </div>
      </div>
      
      <div class="card mt-3">
        <div class="card-title">What's Included</div>
        <ul style="margin-top: 12px; color: var(--gray-700);">
          <li>Automated commission calculations with split tracking</li>
          <li>MLS data integration formulas</li>
          <li>Client follow-up scheduling</li>
          <li>Property cash flow analysis</li>
          <li>Tax deduction tracking</li>
        </ul>
      </div>
    </div>
    
    <!-- Construction Templates -->
    <div id="construction" class="category-content" style="display: none;">
      <div class="feature-grid">
        <div class="feature-card">
          <div class="feature-title">Master Construction Estimator</div>
          <div class="feature-description">Professional construction project estimating system with material waste tracking, labor productivity analysis, subcontractor management, and comprehensive project dashboard with real-time alerts.</div>
          <div class="feature-benefits">✓ Save 20+ hours per project ✓ 15-20% waste reduction ✓ Real-time budget alerts</div>
          <div class="template-actions">
            <button class="btn-preview" onclick="previewTemplate('cost-estimator')">Preview</button>
            <button class="btn-apply" onclick="applyTemplate('cost-estimator')">Apply Template</button>
          </div>
        </div>
        
        <div class="feature-card">
          <div class="feature-title">Material & Inventory Manager</div>
          <div class="feature-description">Advanced material tracking system with supplier management, purchase order automation, delivery scheduling, and comprehensive waste analysis. Includes automated reorder points.</div>
          <div class="feature-benefits">✓ Reduce material waste 15-20% ✓ Automate purchase orders ✓ Track supplier performance</div>
          <div class="template-actions">
            <button class="btn-preview" onclick="previewTemplate('material-tracker')">Preview</button>
            <button class="btn-apply" onclick="applyTemplate('material-tracker')">Apply Template</button>
          </div>
        </div>
        
        <div class="feature-card">
          <div class="feature-title">Labor Productivity Suite</div>
          <div class="feature-description">Complete labor management system with time tracking, productivity analysis, payroll integration, and safety compliance monitoring. Includes overtime calculations and performance benchmarking.</div>
          <div class="feature-benefits">✓ Track labor productivity ✓ Automate payroll calculations ✓ Monitor safety compliance</div>
          <div class="template-actions">
            <button class="btn-preview" onclick="previewTemplate('labor-manager')">Preview</button>
            <button class="btn-apply" onclick="applyTemplate('labor-manager')">Apply Template</button>
          </div>
        </div>
        
        <div class="feature-card">
          <div class="feature-title">Change Order Management</div>
          <div class="feature-description">Professional change order tracking system with cost impact analysis, schedule adjustment calculations, approval workflows, and comprehensive reporting. Control scope creep effectively.</div>
          <div class="feature-benefits">✓ Control scope creep ✓ Track cost impacts ✓ Streamline approvals</div>
          <div class="template-actions">
            <button class="btn-preview" onclick="previewTemplate('change-orders')">Preview</button>
            <button class="btn-apply" onclick="applyTemplate('change-orders')">Apply Template</button>
          </div>
        </div>
      </div>
      
      <div class="card mt-3" style="background: var(--primary-50); border: 1px solid var(--primary-200);">
        <div class="card-title" style="color: var(--primary-700); font-size: 13px;">Construction Features</div>
        <div style="margin-top: 8px; font-size: 11px; color: var(--primary-600); line-height: 1.6;">
          <div>✓ Advanced cost estimation formulas</div>
          <div>✓ 10-15% contingency planning</div>
          <div>✓ Material waste tracking system</div>
          <div>✓ Resource allocation optimization</div>
          <div>✓ Safety compliance monitoring</div>
        </div>
      </div>
    </div>
    
    <!-- Healthcare Templates -->
    <div id="healthcare" class="category-content" style="display: none;">
      <div class="feature-grid">
        <div class="feature-card">
          <div class="feature-title">Advanced Billing Suite</div>
          <div class="feature-description">Complete revenue cycle management with automated denial handling, appeal tracking, and insurance verification workflows for healthcare practices</div>
          <div class="template-actions">
            <button class="btn-preview" onclick="previewTemplate('insurance-verifier')">Preview</button>
            <button class="btn-apply" onclick="applyTemplate('insurance-verifier')">Apply Template</button>
          </div>
        </div>
        
        <div class="feature-card">
          <div class="feature-title">Prior Authorization Manager</div>
          <div class="feature-description">Streamlined prior authorization tracking system with automated workflow management and approval status monitoring</div>
          <div class="template-actions">
            <button class="btn-preview" onclick="previewTemplate('prior-auth-tracker')">Preview</button>
            <button class="btn-apply" onclick="applyTemplate('prior-auth-tracker')">Apply Template</button>
          </div>
        </div>
        
        <div class="feature-card">
          <div class="feature-title">Revenue Dashboard</div>
          <div class="feature-description">Comprehensive KPI tracking with accounts receivable aging, collection metrics, and financial performance analytics</div>
          <div class="template-actions">
            <button class="btn-preview" onclick="previewTemplate('revenue-cycle')">Preview</button>
            <button class="btn-apply" onclick="applyTemplate('revenue-cycle')">Apply Template</button>
          </div>
        </div>
        
        <div class="feature-card">
          <div class="feature-title">Denial Analytics System</div>
          <div class="feature-description">Advanced root cause analysis for claim denials with prevention strategies and trend monitoring to reduce rejection rates</div>
          <div class="template-actions">
            <button class="btn-preview" onclick="previewTemplate('denial-analytics')">Preview</button>
            <button class="btn-apply" onclick="applyTemplate('denial-analytics')">Apply Template</button>
          </div>
        </div>
      </div>
      
      <div class="card mt-3">
        <div class="card-title">What's Included</div>
        <ul style="margin-top: 12px; color: var(--gray-700);">
          <li>HIPAA-compliant data handling templates</li>
          <li>Insurance verification from 12.6 min to 5 sec</li>
          <li>Denial tracking (15% average rate reduction)</li>
          <li>Prior auth workflow automation</li>
          <li>$496 billion in addressable admin costs</li>
        </ul>
      </div>
    </div>
    
    <!-- Marketing Templates -->
    <div id="marketing" class="category-content" style="display: none;">
      <div class="feature-grid">
        <div class="feature-card">
          <div class="feature-title">Campaign Tracker & Analytics Suite</div>
          <div class="feature-description">Comprehensive marketing campaign management system with 8 integrated sheets: Dashboard with real-time KPIs, Campaign planning and tracking, Performance analytics across channels, Budget allocation and ROI analysis, Creative asset management, and detailed reporting.</div>
          <div class="feature-benefits">✓ Save 15+ hours weekly ✓ Track campaign ROI across all channels ✓ Automate performance reporting</div>
          <div class="template-actions">
            <button class="btn-preview" onclick="previewTemplate('campaign-tracker')">Preview</button>
            <button class="btn-apply" onclick="applyTemplate('campaign-tracker')">Apply Template</button>
          </div>
        </div>
        
        <div class="feature-card">
          <div class="feature-title">Lead Scoring & Qualification System</div>
          <div class="feature-description">Advanced behavioral and demographic lead scoring system with automated qualification workflows, conversion probability analysis, and lead nurturing campaigns. Track lead progression and optimize conversion funnels.</div>
          <div class="feature-benefits">✓ 40% better lead conversion ✓ Automated lead qualification ✓ Behavioral scoring engine</div>
          <div class="template-actions">
            <button class="btn-preview" onclick="previewTemplate('lead-scoring-system')">Preview</button>
            <button class="btn-apply" onclick="applyTemplate('lead-scoring-system')">Apply Template</button>
          </div>
        </div>
        
        <div class="feature-card">
          <div class="feature-title">Competitor Analysis Dashboard</div>
          <div class="feature-description">Comprehensive competitive intelligence system with market positioning analysis, competitor tracking, pricing comparison, and strategic opportunity identification. Monitor competitive landscape effectively.</div>
          <div class="feature-benefits">✓ Track competitor activities ✓ Identify market opportunities ✓ Strategic positioning insights</div>
          <div class="template-actions">
            <button class="btn-preview" onclick="previewTemplate('competitor-analysis')">Preview</button>
            <button class="btn-apply" onclick="applyTemplate('competitor-analysis')">Apply Template</button>
          </div>
        </div>
        
        <div class="feature-card">
          <div class="feature-title">Brand Awareness Tracker</div>
          <div class="feature-description">Brand performance monitoring system with awareness metrics, sentiment analysis, social media tracking, and brand health scoring. Measure and improve brand perception across all touchpoints.</div>
          <div class="feature-benefits">✓ Monitor brand health ✓ Track sentiment trends ✓ Measure share of voice</div>
          <div class="template-actions">
            <button class="btn-preview" onclick="previewTemplate('brand-awareness')">Preview</button>
            <button class="btn-apply" onclick="applyTemplate('brand-awareness')">Apply Template</button>
          </div>
        </div>
        
        <div class="feature-card">
          <div class="feature-title">Customer Lifetime Value Analytics</div>
          <div class="feature-description">Advanced CLV analysis with cohort tracking, retention analysis, churn prediction, and customer segmentation. Optimize customer acquisition costs and maximize long-term value.</div>
          <div class="feature-benefits">✓ Predict customer churn ✓ Optimize acquisition costs ✓ Segment high-value customers</div>
          <div class="template-actions">
            <button class="btn-preview" onclick="previewTemplate('customer-lifetime-value')">Preview</button>
            <button class="btn-apply" onclick="applyTemplate('customer-lifetime-value')">Apply Template</button>
          </div>
        </div>
      </div>
      
      <div class="card mt-3">
        <div class="card-title">What's Included</div>
        <ul style="margin-top: 12px; color: var(--gray-700);">
          <li>8-sheet comprehensive campaign tracker with real-time dashboards</li>
          <li>Multi-channel attribution modeling and ROI tracking</li>
          <li>Automated lead scoring with behavioral and demographic factors</li>
          <li>Competitive intelligence with market positioning analysis</li>
          <li>Brand health monitoring with sentiment analysis</li>
          <li>Customer lifetime value analytics with churn prediction</li>
        </ul>
      </div>
    </div>
    
    <!-- E-Commerce Templates -->
    <div id="ecommerce" class="category-content" style="display: none;">
      <div class="feature-grid">
        <div class="feature-card">
          <div class="feature-title">Sales Dashboard & Analytics Suite</div>
          <div class="feature-description">Comprehensive e-commerce management system with 8 integrated sheets: Executive dashboard with KPIs, Sales data tracking, Product performance analytics, Customer insights and segmentation, Order management and fulfillment, Channel performance analysis, Sales trends and forecasting, and executive reporting.</div>
          <div class="feature-benefits">✓ Save 20+ hours weekly ✓ Track sales across all channels ✓ Optimize inventory automatically</div>
          <div class="template-actions">
            <button class="btn-preview" onclick="previewTemplate('sales-dashboard')">Preview</button>
            <button class="btn-apply" onclick="applyTemplate('sales-dashboard')">Apply Template</button>
          </div>
        </div>
        
        <div class="feature-card">
          <div class="feature-title">Inventory Management System</div>
          <div class="feature-description">Advanced inventory tracking with automated reorder points, supplier management, stock level optimization, and multi-channel synchronization across Amazon, eBay, Shopify, and other marketplaces.</div>
          <div class="feature-benefits">✓ Prevent stockouts ✓ Reduce carrying costs ✓ Multi-channel sync</div>
          <div class="template-actions">
            <button class="btn-preview" onclick="previewTemplate('inventory-manager')">Preview</button>
            <button class="btn-apply" onclick="applyTemplate('inventory-manager')">Apply Template</button>
          </div>
        </div>
        
        <div class="feature-card">
          <div class="feature-title">Customer Analytics Platform</div>
          <div class="feature-description">Deep customer behavior analysis with segmentation, lifetime value tracking, churn prediction, and personalized marketing insights. Understand and optimize your customer base effectively.</div>
          <div class="feature-benefits">✓ Increase customer LTV ✓ Reduce churn rates ✓ Personalize marketing</div>
          <div class="template-actions">
            <button class="btn-preview" onclick="previewTemplate('customer-analytics')">Preview</button>
            <button class="btn-apply" onclick="applyTemplate('customer-analytics')">Apply Template</button>
          </div>
        </div>
        
        <div class="feature-card">
          <div class="feature-title">Product Performance Analyzer</div>
          <div class="feature-description">Advanced SKU profitability analysis with marketplace fees calculation, category performance tracking, pricing optimization recommendations, and competitive analysis tools.</div>
          <div class="feature-benefits">✓ Optimize product mix ✓ Increase margins ✓ Beat competition</div>
          <div class="template-actions">
            <button class="btn-preview" onclick="previewTemplate('product-performance')">Preview</button>
            <button class="btn-apply" onclick="applyTemplate('product-performance')">Apply Template</button>
          </div>
        </div>
        
        <div class="feature-card">
          <div class="feature-title">Financial Performance Tracker</div>
          <div class="feature-description">Complete financial analysis with P&L tracking, cash flow management, profitability analysis by channel, and comprehensive financial reporting for e-commerce businesses.</div>
          <div class="feature-benefits">✓ Track profitability ✓ Manage cash flow ✓ Financial reporting</div>
          <div class="template-actions">
            <button class="btn-preview" onclick="previewTemplate('financial-tracker')">Preview</button>
            <button class="btn-apply" onclick="applyTemplate('financial-tracker')">Apply Template</button>
          </div>
        </div>
      </div>
      
      <div class="card mt-3">
        <div class="card-title">What's Included</div>
        <ul style="margin-top: 12px; color: var(--gray-700);">
          <li>8-sheet comprehensive sales dashboard with real-time analytics</li>
          <li>Multi-marketplace inventory synchronization and management</li>
          <li>Advanced customer segmentation and lifetime value tracking</li>
          <li>Product performance analysis with profitability optimization</li>
          <li>Financial tracking with P&L and cash flow management</li>
          <li>Automated alerts and notifications for key business metrics</li>
        </ul>
      </div>
    </div>
    
    <!-- Professional Services Templates -->
    <div id="professional" class="category-content" style="display: none;">
      <div class="feature-grid">
        <div class="feature-card">
          <div class="feature-title">Project Tracker & Management Suite</div>
          <div class="feature-description">Comprehensive professional services management system with 8 integrated sheets: Command center dashboard with project health KPIs, Project portfolio management, Task tracking and assignment, Resource allocation and utilization, Timeline and milestone tracking, Budget and financial management, Deliverable tracking, and executive reporting.</div>
          <div class="feature-benefits">✓ Save 25+ hours weekly ✓ Improve project margins by 15% ✓ Track team utilization</div>
          <div class="template-actions">
            <button class="btn-preview" onclick="previewTemplate('project-tracker')">Preview</button>
            <button class="btn-apply" onclick="applyTemplate('project-tracker')">Apply Template</button>
          </div>
        </div>
        
        <div class="feature-card">
          <div class="feature-title">Time & Billing Management</div>
          <div class="feature-description">Advanced time tracking and billing system with automated invoicing workflows, billable hours optimization, time allocation analysis, and comprehensive billing management for professional services.</div>
          <div class="feature-benefits">✓ Automate invoicing ✓ Track billable efficiency ✓ Reduce billing errors</div>
          <div class="template-actions">
            <button class="btn-preview" onclick="previewTemplate('time-billing')">Preview</button>
            <button class="btn-apply" onclick="applyTemplate('time-billing')">Apply Template</button>
          </div>
        </div>
        
        <div class="feature-card">
          <div class="feature-title">Resource Planning System</div>
          <div class="feature-description">Strategic resource allocation and capacity planning with team utilization tracking, skills management, workload balancing, and availability forecasting for optimal resource optimization.</div>
          <div class="feature-benefits">✓ Optimize team utilization ✓ Plan capacity effectively ✓ Balance workloads</div>
          <div class="template-actions">
            <button class="btn-preview" onclick="previewTemplate('resource-planner')">Preview</button>
            <button class="btn-apply" onclick="applyTemplate('resource-planner')">Apply Template</button>
          </div>
        </div>
        
        <div class="feature-card">
          <div class="feature-title">Proposal & Pipeline Tracker</div>
          <div class="feature-description">Complete proposal management system with pipeline tracking, win/loss analysis, proposal templates, client interaction tracking, and opportunity scoring for business development optimization.</div>
          <div class="feature-benefits">✓ Increase win rates ✓ Track pipeline health ✓ Streamline proposals</div>
          <div class="template-actions">
            <button class="btn-preview" onclick="previewTemplate('proposal-tracker')">Preview</button>
            <button class="btn-apply" onclick="applyTemplate('proposal-tracker')">Apply Template</button>
          </div>
        </div>
        
        <div class="feature-card">
          <div class="feature-title">Financial Dashboard & Analytics</div>
          <div class="feature-description">Comprehensive financial management with P&L tracking, cash flow analysis, project profitability monitoring, invoice management, and financial performance analytics for professional services firms.</div>
          <div class="feature-benefits">✓ Monitor profitability ✓ Track cash flow ✓ Analyze performance</div>
          <div class="template-actions">
            <button class="btn-preview" onclick="previewTemplate('financial-dashboard')">Preview</button>
            <button class="btn-apply" onclick="applyTemplate('financial-dashboard')">Apply Template</button>
          </div>
        </div>
      </div>
      
      <div class="card mt-3">
        <div class="card-title">What's Included</div>
        <ul style="margin-top: 12px; color: var(--gray-700);">
          <li>8-sheet comprehensive project management with real-time dashboards</li>
          <li>Advanced time tracking with automated billing and invoicing</li>
          <li>Resource allocation optimization with capacity planning</li>
          <li>Proposal pipeline management with win/loss tracking</li>
          <li>Financial analytics with project profitability monitoring</li>
          <li>Team performance metrics and utilization analysis</li>
        </ul>
      </div>
    </div>
    
    <!-- Implementation Guide -->
    <div class="card" style="background: linear-gradient(135deg, rgba(34, 197, 94, 0.04), rgba(34, 197, 94, 0.08)); margin-top: 24px;">
      <div class="card-title">Quick Start Guide</div>
      <div class="card-description">Get up and running in minutes</div>
      
      <ol style="margin-top: 16px; padding-left: 20px; color: var(--gray-700);">
        <li style="margin-bottom: 8px;">Select your industry template above</li>
        <li style="margin-bottom: 8px;">Template automatically creates sheets and formulas</li>
        <li style="margin-bottom: 8px;">Customize fields for your business</li>
        <li style="margin-bottom: 8px;">Import existing data (we'll help format it)</li>
        <li style="margin-bottom: 8px;">Start saving 15-25 hours weekly!</li>
      </ol>
    </div>
  </div>
  
  <script>
    // Check if a default category was passed and switch to it on load
    <? if (typeof defaultCategory !== 'undefined' && defaultCategory) { ?>
      document.addEventListener('DOMContentLoaded', function() {
        // Hide all categories first
        document.querySelectorAll('.category-content').forEach(content => {
          content.style.display = 'none';
        });
        
        // Show the selected category
        const categoryElement = document.getElementById('<?= defaultCategory ?>');
        if (categoryElement) {
          categoryElement.style.display = 'block';
        }
        
        // Update button states
        document.querySelectorAll('.tab-button').forEach(btn => {
          btn.classList.remove('active');
        });
        
        // Find and activate the corresponding button
        const categoryMap = {
          'real-estate': 0,
          'construction': 1,
          'healthcare': 2,
          'marketing': 3,
          'ecommerce': 4,
          'professional': 5
        };
        
        const tabIndex = categoryMap['<?= defaultCategory ?>'] || 0;
        const buttons = document.querySelectorAll('.tab-button');
        if (buttons[tabIndex]) {
          buttons[tabIndex].classList.add('active');
        }
      });
    <? } ?>
    
    function backToMain() {
      // Clean up preview sheets before going back
      cleanupPreviews();
      google.script.run.showCellPilotSidebar();
    }
    
    function switchCategory(category) {
      // Clean up any preview sheets when switching categories
      cleanupPreviews();
      
      // Update button states for grid layout
      document.querySelectorAll('.industry-btn').forEach(btn => {
        btn.classList.remove('active');
      });
      
      // Find and activate the clicked button
      const clickedBtn = event.target.closest('.industry-btn');
      if (clickedBtn) {
        clickedBtn.classList.add('active');
      }
      
      // Show/hide content
      document.querySelectorAll('.category-content').forEach(content => {
        content.style.display = 'none';
      });
      const categoryEl = document.getElementById(category);
      if (categoryEl) {
        categoryEl.style.display = 'block';
      }
    }
    
    function showStatus(message, type = 'info') {
      const statusDiv = document.getElementById('statusMessage');
      statusDiv.className = 'alert alert-' + type;
      statusDiv.textContent = message;
      statusDiv.style.display = 'flex';
      
      if (type === 'success') {
        setTimeout(() => {
          statusDiv.style.display = 'none';
        }, 5000);
      }
    }
    
    function previewTemplate(templateType) {
      showStatus('Creating preview sheets for ' + templateType.replace(/-/g, ' ') + '...', 'info');
      
      google.script.run
        .withSuccessHandler(function(result) {
          if (result.success) {
            showStatus('Preview sheets created! Check your spreadsheet tabs for [PREVIEW] sheets.', 'success');
            // Optionally show which sheets were created
            if (result.sheets && result.sheets.length > 0) {
              setTimeout(() => {
                showStatus('Created preview sheets: ' + result.sheets.join(', '), 'info');
              }, 2000);
            }
          } else {
            showStatus(result.error || result.message || 'Failed to create preview', 'error');
          }
        })
        .withFailureHandler(function(error) {
          showStatus('Error: ' + error.message, 'error');
        })
        .previewTemplate(templateType);
    }
    
    // Modal functions removed - preview now creates actual sheets
    // Keeping stubs in case they're referenced elsewhere
    function showTemplatePreview(preview) {
      // Deprecated - preview creates actual sheets now
    }
    
    function closeTemplatePreview() {
      // Deprecated - no modal to close
    }
    
    function applyTemplateFromPreview(templateType) {
      applyTemplate(templateType);
    }

    function applyTemplate(templateType) {
      showStatus('Applying ' + templateType.replace('-', ' ') + ' template...', 'info');
      
      google.script.run
        .withSuccessHandler(function(result) {
          if (result.success) {
            showStatus('Template applied successfully! Check your new sheets.', 'success');
            
            // Optionally navigate to the first sheet created
            if (result.sheets && result.sheets.length > 0) {
              setTimeout(() => {
                google.script.run.navigateToSheet(result.sheets[0]);
              }, 2000);
            }
          } else {
            showStatus(result.error || 'Failed to apply template', 'error');
          }
        })
        .withFailureHandler(function(error) {
          showStatus('Error: ' + error.message, 'error');
        })
        .applyIndustryTemplate(templateType);
    }
    
    // Clean up preview sheets when switching sectors or back button
    function cleanupPreviews() {
      google.script.run
        .withSuccessHandler(function(result) {
          console.log('Preview sheets cleaned up');
        })
        .withFailureHandler(function(error) {
          console.error('Cleanup error:', error);
        })
        .cleanupIndustryPreviews();
    }
    
    // Add cleanup when switching sectors
    window.addEventListener('DOMContentLoaded', function() {
      // Clean up when switching between sectors
      const sectorButtons = document.querySelectorAll('.sector-item');
      sectorButtons.forEach(button => {
        button.addEventListener('click', function() {
          // Clean up any existing preview sheets when switching sectors
          cleanupPreviews();
        });
      });
      
      // Clean up when clicking back button
      const backBtn = document.querySelector('.nav-back');
      if (backBtn) {
        backBtn.addEventListener('click', function() {
          cleanupPreviews();
        });
      }
    });
    
    // Try to clean up when sidebar is about to close
    window.addEventListener('beforeunload', function(e) {
      // Note: This may not always work due to browser restrictions
      cleanupPreviews();
    });
    
    // Also clean up when visibility changes (sidebar hidden)
    document.addEventListener('visibilitychange', function() {
      if (document.hidden) {
        cleanupPreviews();
      }
    });
  </script>
</body>
</html>