<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <?!= include('SharedStyles'); ?>
  <style>
    .cellm8-header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 20px;
      border-radius: 12px;
      margin-bottom: 20px;
      text-align: center;
      position: relative;
      overflow: hidden;
    }
    
    .cellm8-header::before {
      content: '';
      position: absolute;
      top: -50%;
      right: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
      animation: shimmer 3s infinite;
    }
    
    @keyframes shimmer {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    .cellm8-title {
      font-size: 24px;
      font-weight: 700;
      margin-bottom: 8px;
      position: relative;
      z-index: 1;
    }
    
    .cellm8-subtitle {
      font-size: 14px;
      opacity: 0.95;
      position: relative;
      z-index: 1;
    }
    
    .cellm8-badge {
      display: inline-block;
      background: rgba(255,255,255,0.2);
      padding: 4px 8px;
      border-radius: 12px;
      font-size: 11px;
      font-weight: 600;
      margin-left: 8px;
      backdrop-filter: blur(10px);
    }
    
    .config-section {
      background: white;
      border-radius: 12px;
      padding: 16px;
      margin-bottom: 16px;
      border: 1px solid var(--gray-200);
      transition: all 0.3s ease;
    }
    
    .config-section:hover {
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
      transform: translateY(-2px);
    }
    
    .section-title {
      font-size: 14px;
      font-weight: 600;
      color: var(--gray-700);
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .section-icon {
      width: 18px;
      height: 18px;
      opacity: 0.7;
    }
    
    .data-source-options {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 8px;
    }
    
    .source-option {
      padding: 12px;
      border: 2px solid var(--gray-200);
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s ease;
      text-align: center;
      font-size: 12px;
      position: relative;
      overflow: hidden;
    }
    
    .source-option:hover {
      border-color: #667eea;
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(102,126,234,0.15);
    }
    
    .source-option.selected {
      border-color: #667eea;
      background: linear-gradient(135deg, rgba(102,126,234,0.1) 0%, rgba(118,75,162,0.1) 100%);
    }
    
    .source-option.selected::after {
      content: '✓';
      position: absolute;
      top: 4px;
      right: 4px;
      background: #667eea;
      color: white;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
    }
    
    .template-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 8px;
    }
    
    .template-card {
      padding: 10px;
      border: 2px solid var(--gray-200);
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s ease;
      text-align: center;
    }
    
    .template-card:hover {
      border-color: #667eea;
      transform: scale(1.05);
    }
    
    .template-card.selected {
      border-color: #667eea;
      background: linear-gradient(135deg, rgba(102,126,234,0.1) 0%, rgba(118,75,162,0.1) 100%);
    }
    
    .template-preview {
      width: 100%;
      height: 40px;
      border-radius: 4px;
      margin-bottom: 6px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
    }
    
    .template-name {
      font-size: 11px;
      font-weight: 600;
      color: var(--gray-700);
    }
    
    .slide-counter {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px;
      background: var(--gray-50);
      border-radius: 8px;
    }
    
    .slide-count {
      font-size: 20px;
      font-weight: 600;
      color: #667eea;
      min-width: 40px;
      text-align: center;
    }
    
    .slide-slider {
      flex: 1;
      margin: 0 16px;
      -webkit-appearance: none;
      height: 6px;
      border-radius: 3px;
      background: linear-gradient(to right, #667eea 0%, #667eea var(--progress), #e5e7eb var(--progress), #e5e7eb 100%);
      outline: none;
    }
    
    .slide-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: #667eea;
      cursor: pointer;
      box-shadow: 0 2px 8px rgba(102,126,234,0.3);
      transition: all 0.2s ease;
    }
    
    .slide-slider::-webkit-slider-thumb:hover {
      transform: scale(1.2);
      box-shadow: 0 4px 12px rgba(102,126,234,0.5);
    }
    
    .style-select {
      width: 100%;
      padding: 10px;
      border: 2px solid var(--gray-200);
      border-radius: 8px;
      font-size: 14px;
      background: white;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    
    .style-select:hover {
      border-color: #667eea;
    }
    
    .style-select:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 3px rgba(102,126,234,0.1);
    }
    
    .advanced-options {
      margin-top: 12px;
      padding-top: 12px;
      border-top: 1px solid var(--gray-200);
    }
    
    .checkbox-option {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 8px;
      cursor: pointer;
    }
    
    .checkbox-option input[type="checkbox"] {
      width: 18px;
      height: 18px;
      cursor: pointer;
    }
    
    .checkbox-label {
      font-size: 13px;
      color: var(--gray-600);
      user-select: none;
    }
    
    .action-buttons {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin-top: 20px;
    }
    
    .btn-preview {
      background: white;
      color: #667eea;
      border: 2px solid #667eea;
      padding: 12px;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }
    
    .btn-preview:hover {
      background: rgba(102,126,234,0.1);
      transform: translateY(-2px);
    }
    
    .btn-generate {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      padding: 12px;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      position: relative;
      overflow: hidden;
    }
    
    .btn-generate::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      border-radius: 50%;
      background: rgba(255,255,255,0.3);
      transform: translate(-50%, -50%);
      transition: width 0.6s, height 0.6s;
    }
    
    .btn-generate:hover::before {
      width: 300px;
      height: 300px;
    }
    
    .btn-generate:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(102,126,234,0.3);
    }
    
    .btn-generate:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    
    .btn-icon {
      width: 16px;
      height: 16px;
    }
    
    .progress-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.7);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 10000;
      backdrop-filter: blur(4px);
    }
    
    .progress-overlay.show {
      display: flex;
    }
    
    .progress-card {
      background: white;
      border-radius: 16px;
      padding: 32px;
      max-width: 400px;
      width: 90%;
      text-align: center;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    }
    
    .progress-spinner {
      width: 60px;
      height: 60px;
      border: 4px solid rgba(102,126,234,0.2);
      border-top-color: #667eea;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 0 auto 20px;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    .progress-title {
      font-size: 18px;
      font-weight: 600;
      color: var(--gray-800);
      margin-bottom: 8px;
    }
    
    .progress-subtitle {
      font-size: 14px;
      color: var(--gray-600);
      margin-bottom: 20px;
    }
    
    .progress-steps {
      text-align: left;
      margin-top: 20px;
    }
    
    .progress-step {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 12px;
      opacity: 0.5;
      transition: all 0.3s ease;
    }
    
    .progress-step.active {
      opacity: 1;
    }
    
    .progress-step.completed {
      opacity: 1;
    }
    
    .step-icon {
      width: 24px;
      height: 24px;
      border-radius: 50%;
      background: var(--gray-200);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      transition: all 0.3s ease;
    }
    
    .progress-step.active .step-icon {
      background: #667eea;
      color: white;
      animation: pulse 1.5s infinite;
    }
    
    .progress-step.completed .step-icon {
      background: #34a853;
      color: white;
    }
    
    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }
    
    .success-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.7);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 10000;
      backdrop-filter: blur(4px);
    }
    
    .success-overlay.show {
      display: flex;
    }
    
    .success-card {
      background: white;
      border-radius: 16px;
      padding: 32px;
      max-width: 400px;
      width: 90%;
      text-align: center;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    }
    
    .success-icon {
      width: 80px;
      height: 80px;
      margin: 0 auto 20px;
      background: linear-gradient(135deg, #34a853 0%, #0f9d58 100%);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      animation: scaleIn 0.5s ease;
    }
    
    @keyframes scaleIn {
      from { transform: scale(0); }
      to { transform: scale(1); }
    }
    
    .success-checkmark {
      color: white;
      font-size: 40px;
    }
    
    .success-title {
      font-size: 20px;
      font-weight: 600;
      color: var(--gray-800);
      margin-bottom: 8px;
    }
    
    .success-subtitle {
      font-size: 14px;
      color: var(--gray-600);
      margin-bottom: 24px;
    }
    
    .success-actions {
      display: grid;
      gap: 12px;
    }
    
    .ai-badge {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      background: linear-gradient(135deg, rgba(102,126,234,0.1) 0%, rgba(118,75,162,0.1) 100%);
      padding: 4px 8px;
      border-radius: 12px;
      font-size: 11px;
      font-weight: 600;
      color: #667eea;
      margin-top: 12px;
    }
    
    .ai-icon {
      width: 14px;
      height: 14px;
    }
  </style>
</head>
<body>
  <div class="cellm8-header">
    <div class="cellm8-title">
      📊 CellM8 Presentations
      <span class="cellm8-badge">NEW</span>
    </div>
    <div class="cellm8-subtitle">Transform your data into stunning presentations with AI</div>
  </div>

  <!-- Data Source Selection -->
  <div class="config-section">
    <div class="section-title">
      <svg class="section-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
      </svg>
      Data Source
    </div>
    <div class="data-source-options">
      <div class="source-option selected" data-source="entireSheet" onclick="selectDataSource(this)">
        <div>📄</div>
        <div>Entire Sheet</div>
      </div>
      <div class="source-option" data-source="selectedRange" onclick="selectDataSource(this)">
        <div>🎯</div>
        <div>Selected Range</div>
      </div>
      <div class="source-option" data-source="visibleOnly" onclick="selectDataSource(this)">
        <div>👁️</div>
        <div>Visible Cells</div>
      </div>
      <div class="source-option" data-source="customRange" onclick="selectDataSource(this)">
        <div>✏️</div>
        <div>Custom Range</div>
      </div>
    </div>
    <div id="customRangeInput" style="display: none; margin-top: 12px;">
      <input type="text" id="customRange" placeholder="e.g., A1:E20" class="form-control">
    </div>
  </div>

  <!-- Template Selection -->
  <div class="config-section">
    <div class="section-title">
      <svg class="section-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6zM16 13a1 1 0 011-1h2a1 1 0 011 1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-6z"/>
      </svg>
      Template
    </div>
    <div class="template-grid">
      <div class="template-card selected" data-template="corporate" onclick="selectTemplate(this)">
        <div class="template-preview" style="background: linear-gradient(135deg, #1f4e79, #4472c4);">💼</div>
        <div class="template-name">Corporate</div>
      </div>
      <div class="template-card" data-template="sales" onclick="selectTemplate(this)">
        <div class="template-preview" style="background: linear-gradient(135deg, #c55a11, #f79646);">📈</div>
        <div class="template-name">Sales</div>
      </div>
      <div class="template-card" data-template="financial" onclick="selectTemplate(this)">
        <div class="template-preview" style="background: linear-gradient(135deg, #1f4e79, #843c0c);">💰</div>
        <div class="template-name">Financial</div>
      </div>
      <div class="template-card" data-template="modern" onclick="selectTemplate(this)">
        <div class="template-preview" style="background: linear-gradient(135deg, #4285f4, #34a853);">🎨</div>
        <div class="template-name">Modern</div>
      </div>
    </div>
  </div>

  <!-- Slide Configuration -->
  <div class="config-section">
    <div class="section-title">
      <svg class="section-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"/>
      </svg>
      Configuration
    </div>
    
    <!-- Slide Count -->
    <div class="slide-counter">
      <span>Slides:</span>
      <input type="range" id="slideCount" class="slide-slider" min="5" max="50" value="12" oninput="updateSlideCount(this.value)">
      <span class="slide-count" id="slideCountDisplay">12</span>
    </div>
    
    <!-- Presentation Style -->
    <div style="margin-top: 12px;">
      <select id="presentationStyle" class="style-select">
        <option value="executive">Executive Summary</option>
        <option value="detailed">Detailed Analysis</option>
        <option value="sales">Sales Report</option>
        <option value="financial">Financial Dashboard</option>
        <option value="project">Project Update</option>
        <option value="custom">Custom</option>
      </select>
    </div>
    
    <!-- Advanced Options -->
    <div class="advanced-options">
      <label class="checkbox-option">
        <input type="checkbox" id="includeCharts" checked>
        <span class="checkbox-label">Include Charts & Visualizations</span>
      </label>
      <label class="checkbox-option">
        <input type="checkbox" id="includeInsights" checked>
        <span class="checkbox-label">Generate AI Insights</span>
      </label>
      <label class="checkbox-option">
        <input type="checkbox" id="includeRecommendations" checked>
        <span class="checkbox-label">Add Recommendations</span>
      </label>
      <label class="checkbox-option">
        <input type="checkbox" id="includeHeaders" checked>
        <span class="checkbox-label">First Row Contains Headers</span>
      </label>
    </div>
  </div>

  <!-- Action Buttons -->
  <div class="action-buttons">
    <button class="btn-preview" onclick="previewPresentation()">
      <svg class="btn-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>
      </svg>
      Preview
    </button>
    <button class="btn-generate" onclick="generatePresentation()">
      <svg class="btn-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/>
      </svg>
      Generate
    </button>
  </div>

  <div class="ai-badge">
    <svg class="ai-icon" fill="currentColor" viewBox="0 0 20 20">
      <path d="M10.394 2.08a1 1 0 00-.788 0l-7 3a1 1 0 000 1.84L5.25 8.051a.999.999 0 01.356-.257l4-1.714a1 1 0 11.788 1.838L7.667 9.088l1.94.831a1 1 0 00.787 0l7-3a1 1 0 000-1.838l-7-3zM3.31 9.397L5 10.12v4.102a8.969 8.969 0 00-1.05-.174 1 1 0 01-.89-.89 11.115 11.115 0 01.25-3.762zM9.3 16.573A9.026 9.026 0 007 14.935v-3.957l1.818.78a3 3 0 002.364 0l5.508-2.361a11.026 11.026 0 01.25 3.762 1 1 0 01-.89.89 8.968 8.968 0 00-5.35 2.524 1 1 0 01-1.4 0zM6 18a1 1 0 001-1v-2.065a8.935 8.935 0 00-2-.712V17a1 1 0 001 1z"/>
    </svg>
    Powered by AI Intelligence
  </div>

  <!-- Progress Overlay -->
  <div id="progressOverlay" class="progress-overlay">
    <div class="progress-card">
      <div class="progress-spinner"></div>
      <div class="progress-title">Creating Your Presentation</div>
      <div class="progress-subtitle">CellM8 is working its magic...</div>
      <div class="progress-steps">
        <div class="progress-step" id="step1">
          <div class="step-icon">1</div>
          <span>Analyzing data patterns...</span>
        </div>
        <div class="progress-step" id="step2">
          <div class="step-icon">2</div>
          <span>Generating insights...</span>
        </div>
        <div class="progress-step" id="step3">
          <div class="step-icon">3</div>
          <span>Creating slide structure...</span>
        </div>
        <div class="progress-step" id="step4">
          <div class="step-icon">4</div>
          <span>Building presentation...</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Success Overlay -->
  <div id="successOverlay" class="success-overlay">
    <div class="success-card">
      <div class="success-icon">
        <span class="success-checkmark">✓</span>
      </div>
      <div class="success-title">Presentation Created!</div>
      <div class="success-subtitle" id="successMessage">Your presentation is ready with 12 slides</div>
      <div class="success-actions">
        <button class="btn btn-primary" onclick="openPresentation()">
          Open Presentation
        </button>
        <button class="btn btn-secondary" onclick="createAnother()">
          Create Another
        </button>
        <button class="btn btn-outline" onclick="copyPresentationLink()">
          Copy Link
        </button>
      </div>
    </div>
  </div>

  <script>
    let selectedDataSource = 'entireSheet';
    let selectedTemplate = 'corporate';
    let presentationUrl = '';
    
    function selectDataSource(element) {
      document.querySelectorAll('.source-option').forEach(opt => {
        opt.classList.remove('selected');
      });
      element.classList.add('selected');
      selectedDataSource = element.dataset.source;
      
      // Show/hide custom range input
      const customInput = document.getElementById('customRangeInput');
      if (selectedDataSource === 'customRange') {
        customInput.style.display = 'block';
      } else {
        customInput.style.display = 'none';
      }
    }
    
    function selectTemplate(element) {
      document.querySelectorAll('.template-card').forEach(card => {
        card.classList.remove('selected');
      });
      element.classList.add('selected');
      selectedTemplate = element.dataset.template;
    }
    
    function updateSlideCount(value) {
      document.getElementById('slideCountDisplay').textContent = value;
      const slider = document.getElementById('slideCount');
      const progress = ((value - 5) / (50 - 5)) * 100;
      slider.style.setProperty('--progress', progress + '%');
    }
    
    function previewPresentation() {
      // TODO: Implement preview functionality
      alert('Preview functionality coming soon!');
    }
    
    function generatePresentation() {
      const config = gatherConfiguration();
      
      if (config.dataSource.type === 'customRange' && !config.dataSource.range) {
        alert('Please specify a custom range');
        return;
      }
      
      showProgress();
      
      google.script.run
        .withSuccessHandler(handlePresentationSuccess)
        .withFailureHandler(handlePresentationError)
        .createCellM8Presentation(config);
    }
    
    function gatherConfiguration() {
      const customRange = document.getElementById('customRange').value;
      
      return {
        dataSource: {
          type: selectedDataSource,
          range: selectedDataSource === 'customRange' ? customRange : null,
          hasHeaders: document.getElementById('includeHeaders').checked
        },
        template: selectedTemplate,
        slideCount: parseInt(document.getElementById('slideCount').value),
        presentationStyle: document.getElementById('presentationStyle').value,
        presentationTitle: 'Data Analysis - ' + new Date().toLocaleDateString(),
        includeCharts: document.getElementById('includeCharts').checked,
        includeInsights: document.getElementById('includeInsights').checked,
        includeRecommendations: document.getElementById('includeRecommendations').checked,
        includeExecutiveSummary: document.getElementById('presentationStyle').value === 'executive'
      };
    }
    
    function showProgress() {
      document.getElementById('progressOverlay').classList.add('show');
      
      // Animate progress steps
      const steps = ['step1', 'step2', 'step3', 'step4'];
      steps.forEach((step, index) => {
        setTimeout(() => {
          document.getElementById(step).classList.add('active');
          if (index > 0) {
            document.getElementById(steps[index - 1]).classList.remove('active');
            document.getElementById(steps[index - 1]).classList.add('completed');
            document.querySelector(`#${steps[index - 1]} .step-icon`).innerHTML = '✓';
          }
        }, (index + 1) * 2000);
      });
    }
    
    function hideProgress() {
      document.getElementById('progressOverlay').classList.remove('show');
      // Reset steps
      ['step1', 'step2', 'step3', 'step4'].forEach(step => {
        document.getElementById(step).classList.remove('active', 'completed');
        const stepNum = step.replace('step', '');
        document.querySelector(`#${step} .step-icon`).innerHTML = stepNum;
      });
    }
    
    function handlePresentationSuccess(result) {
      hideProgress();
      
      if (result.success) {
        presentationUrl = result.presentationUrl;
        document.getElementById('successMessage').textContent = 
          `Your presentation is ready with ${result.slideCount} slides`;
        document.getElementById('successOverlay').classList.add('show');
      } else {
        alert('Error: ' + result.error);
      }
    }
    
    function handlePresentationError(error) {
      hideProgress();
      alert('Failed to create presentation: ' + error);
    }
    
    function openPresentation() {
      if (presentationUrl) {
        window.open(presentationUrl, '_blank');
      }
      document.getElementById('successOverlay').classList.remove('show');
    }
    
    function createAnother() {
      document.getElementById('successOverlay').classList.remove('show');
      // Reset form if needed
    }
    
    function copyPresentationLink() {
      if (presentationUrl) {
        const tempInput = document.createElement('input');
        tempInput.value = presentationUrl;
        document.body.appendChild(tempInput);
        tempInput.select();
        document.execCommand('copy');
        document.body.removeChild(tempInput);
        
        // Show feedback
        const button = event.target;
        const originalText = button.textContent;
        button.textContent = 'Copied!';
        setTimeout(() => {
          button.textContent = originalText;
        }, 2000);
      }
    }
    
    // Initialize slider progress bar
    updateSlideCount(12);
  </script>
</body>
</html>